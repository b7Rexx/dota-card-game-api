{"version":3,"sources":["../../src/middlewares/authenticate.js"],"names":["authenticate","req","res","next","token","header","Boom","unauthorized","then","decoded","AuthID","id","catch","err","name"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA;;;;;;;;AAQe,SAASA,YAAT,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,IAAhC,EAAsC;AACnD,MAAIC,KAAK,GAAG,EAAZ;AAEA,MAAIH,GAAG,CAACI,MAAJ,CAAW,eAAX,CAAJ,EAAiCD,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,eAAX,CAAR,CAAjC,KACK,IAAIJ,GAAG,CAACI,MAAJ,CAAW,OAAX,CAAJ,EAAyBD,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,OAAX,CAAR,CAAzB,KACA,IAAIJ,GAAG,CAACG,KAAR,EAAeA,KAAK,GAAGH,GAAG,CAACG,KAAZ,CAAf,KACA,MAAME,cAAKC,YAAL,CAAkB,cAAlB,CAAN;AAEL,+BAAeH,KAAf,EACGI,IADH,CACSC,OAAD,IAAa;AACjBR,IAAAA,GAAG,CAACS,MAAJ,GAAaD,OAAO,CAACE,EAArB,CADiB,CAEjB;;AACAR,IAAAA,IAAI;AACL,GALH,EAMGS,KANH,CAMUC,GAAD,IAAS;AACd,WAAOV,IAAI,CAACG,cAAKC,YAAL,CAAkBM,GAAG,CAACC,IAAtB,CAAD,CAAX;AACD,GARH;AASD","sourcesContent":["import Boom from '@hapi/boom';\nimport { verifyJwtToken } from '../utils/jwtAuth';\n\n/**\n * Middleware to handle authentication.\n * Adds user_id to request body.\n *\n * @param  {Object}   req\n * @param  {Object}   res\n * @param  {Function} next\n */\nexport default function authenticate(req, res, next) {\n  let token = '';\n\n  if (req.header('Authorization')) token = req.header('Authorization');\n  else if (req.header('Token')) token = req.header('Token');\n  else if (req.token) token = req.token;\n  else throw Boom.unauthorized('Missing Auth');\n\n  verifyJwtToken(token)\n    .then((decoded) => {\n      req.AuthID = decoded.id;\n      // req.body.user_id = decoded.id;\n      next();\n    })\n    .catch((err) => {\n      return next(Boom.unauthorized(err.name));\n    });\n}\n"],"file":"authenticate.js"}