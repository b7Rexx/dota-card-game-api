{"version":3,"sources":["../../src/middlewares/authenticate.js"],"names":["authenticate","req","res","next","token","header","Boom","unauthorized","then","decoded","body","user_id","id","catch","err","name"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA;;;;;;;;AAQe,SAASA,YAAT,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,IAAhC,EAAsC;AACnD,MAAIC,KAAK,GAAG,EAAZ;AAEA,MAAIH,GAAG,CAACI,MAAJ,CAAW,eAAX,CAAJ,EAAiCD,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,eAAX,CAAR,CAAjC,KACK,IAAIJ,GAAG,CAACI,MAAJ,CAAW,OAAX,CAAJ,EAAyBD,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,OAAX,CAAR,CAAzB,KACA,IAAIJ,GAAG,CAACG,KAAR,EAAeA,KAAK,GAAGH,GAAG,CAACG,KAAZ,CAAf,KACA,MAAME,cAAKC,YAAL,CAAkB,cAAlB,CAAN;AAEL,+BAAeH,KAAf,EACGI,IADH,CACSC,OAAD,IAAa;AACjBR,IAAAA,GAAG,CAACS,IAAJ,CAASC,OAAT,GAAmBF,OAAO,CAACG,EAA3B;AACAT,IAAAA,IAAI;AACL,GAJH,EAKGU,KALH,CAKUC,GAAD,IAAS;AACd,WAAOX,IAAI,CAACG,cAAKC,YAAL,CAAkBO,GAAG,CAACC,IAAtB,CAAD,CAAX;AACD,GAPH;AAQD","sourcesContent":["import Boom from '@hapi/boom';\r\nimport { verifyJwtToken } from '../utils/jwtAuth';\r\n\r\n/**\r\n * Middleware to handle authentication.\r\n * Adds user_id to request body.\r\n *\r\n * @param  {Object}   req\r\n * @param  {Object}   res\r\n * @param  {Function} next\r\n */\r\nexport default function authenticate(req, res, next) {\r\n  let token = '';\r\n\r\n  if (req.header('Authorization')) token = req.header('Authorization');\r\n  else if (req.header('Token')) token = req.header('Token');\r\n  else if (req.token) token = req.token;\r\n  else throw Boom.unauthorized('Missing Auth');\r\n\r\n  verifyJwtToken(token)\r\n    .then((decoded) => {\r\n      req.body.user_id = decoded.id;\r\n      next();\r\n    })\r\n    .catch((err) => {\r\n      return next(Boom.unauthorized(err.name));\r\n    });\r\n}\r\n"],"file":"authenticate.js"}